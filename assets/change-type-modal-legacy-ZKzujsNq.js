System.register(["./chakra-legacy-HBaSrP-q.js","./index-legacy-AXpxI27a.js","./react-legacy-T1GznqXM.js","./graph-legacy-I-PvKok9.js","./stations-legacy-dW3F-_Kf.js"],(function(e,t){"use strict";var s,n,a,r,i,l,o,c,d,u,g,h,p,y,m,f,b,S,j,x,A,C,E,v,O,T,N,L,w,z,W,k,I,P,B,F,_,M;return{setters:[e=>{s=e.j,n=e.at,a=e.$,r=e.au,i=e.a1,l=e.a4,o=e.a2,c=e.a3,d=e.aM,u=e.aN,g=e.aO,h=e.B,p=e.aP,y=e.aQ,m=e.a5,f=e.O},e=>{b=e.S,S=e.ac,j=e.m,x=e.L,A=e.o,C=e.f,E=e.a,v=e.q,O=e.t,T=e.v,N=e.C,L=e.c,w=e.l,z=e._,W=e.R,k=e.T,I=e.H,P=e.j},e=>{B=e.u,F=e.b},e=>{_=e.c},e=>{M=e.s}],execute:function(){const t=[b.ShmetroBasic2020],R=e("b",((e,s,n)=>{const a=e.getNodeAttribute(s,"type"),r=structuredClone(e.getNodeAttribute(s,a).names);for(let t=0;t<Math.abs(M[n].defaultAttrs.names.length-r.length);t++)M[n].defaultAttrs.names.length>r.length?r.push("Stn"):r.pop();const i={...M[n].defaultAttrs,names:r};Object.values(t).includes(a)&&Object.values(t).includes(n)||(i.nameOffsetX=e.getNodeAttribute(s,a).nameOffsetX,i.nameOffsetY=e.getNodeAttribute(s,a).nameOffsetY),e.removeNodeAttribute(s,a),e.mergeNodeAttributes(s,{type:n,[n]:i})})),D=e("c",((e,t,s)=>{const n=e.getEdgeAttribute(t,"type"),a=e.getEdgeAttribute(t,"style");if(S[a].metadata.supportLinePathType.includes(s)){e.removeEdgeAttribute(t,n);const a=structuredClone(j[s].defaultAttrs);e.mergeEdgeAttributes(t,{type:s,[s]:a})}})),H=e("a",((e,t,s,n)=>{const a=e.getEdgeAttribute(t,"type"),r=e.getEdgeAttribute(t,"style");if(S[s].metadata.supportLinePathType.includes(a)){const a=e.getEdgeAttribute(t,"zIndex"),i=e.getEdgeAttribute(t,r);e.removeEdgeAttribute(t,r);const l=structuredClone(S[s].defaultAttrs);x.includes(r)&&x.includes(s)?l.color=i.color:x.includes(s)&&n&&(l.color=n),e.mergeEdgeAttributes(t,{style:s,[s]:l}),s===A.River?e.setEdgeAttribute(t,"zIndex",-5):e.setEdgeAttribute(t,"zIndex",null!=a?a:0)}}));e("C",(e=>{const{isOpen:t,onClose:X,isSelect:Y,filter:Z}=e,{t:q}=B(),Q=C(),{selected:$,theme:G,paletteAppClip:{output:J}}=E((e=>e.runtime)),K=F.useCallback((()=>{Q(v()),Q(O()),Q(T(U.current.export()))}),[Q,v,O,T]),U=F.useRef(window.graph),V={any:q("header.settings.procedures.changeType.any"),...Object.fromEntries(Object.entries(j).map((([e,t])=>[e,q(t.metadata.displayName).toString()])))},ee={any:q("header.settings.procedures.changeType.any"),...Object.fromEntries(Object.entries(S).map((([e,t])=>[e,q(t.metadata.displayName).toString()])))},te={any:q("header.settings.procedures.changeType.any"),...Object.fromEntries(Object.entries(M).map((([e,t])=>[e,q(t.metadata.displayName).toString()])))},se={id:"any",theme:[N.Other,"other","#ffffff",L.black],value:q("header.settings.procedures.changeType.any")},[ne,ae]=F.useState(!1),[re,ie]=F.useState(0),[le,oe]=F.useState(!1),[ce,de]=F.useState("any"),[ue,ge]=F.useState(b.ShmetroBasic),[he,pe]=F.useState(!1),[ye,me]=F.useState("any"),[fe,be]=F.useState(A.SingleColor),[Se,je]=F.useState(!1),[xe,Ae]=F.useState("any"),[Ce,Ee]=F.useState(w.Diagonal),[ve,Oe]=F.useState(!1),[Te,Ne]=F.useState(se),[Le,we]=F.useState(G),[ze,We]=F.useState(!1);F.useEffect((()=>{ze&&J&&(we(J),We(!1))}),[null==J?void 0:J.toString()]);const[ke,Ie]=F.useState([]),Pe=[{id:"changeZIndex",title:q("header.settings.procedures.changeZIndex"),onClose:()=>ae(!ne),field:[{type:"select",label:q("panel.details.info.zIndex"),value:re,options:Object.fromEntries(Array.from({length:11},((e,t)=>[t-5,(t-5).toString()]))),onChange:e=>ie(Number(e))}]},{id:"changeStationType",title:q("header.settings.procedures.changeStationType.title"),onClose:()=>oe(!le),field:[{type:"select",label:q("header.settings.procedures.changeStationType.changeFrom"),options:te,value:ce,disabledOptions:[ue],onChange:e=>de(e)},{type:"select",label:q("header.settings.procedures.changeStationType.changeTo"),options:te,value:ue,disabledOptions:["any",ce],onChange:e=>ge(e)}]},{id:"changeLineStyleType",title:q("header.settings.procedures.changeLineStyleType.title"),onClose:()=>pe(!he),field:[{type:"select",label:q("header.settings.procedures.changeLineStyleType.changeFrom"),options:ee,value:ye,disabledOptions:[fe],onChange:e=>me(e)},{type:"select",label:q("header.settings.procedures.changeLineStyleType.changeTo"),options:ee,value:fe,disabledOptions:["any",ye],onChange:e=>be(e)}]},{id:"changeLinePathType",title:q("header.settings.procedures.changeLinePathType.title"),onClose:()=>je(!Se),field:[{type:"select",label:q("header.settings.procedures.changeLinePathType.changeFrom"),options:V,value:xe,disabledOptions:[Ce],onChange:e=>Ae(e)},{type:"select",label:q("header.settings.procedures.changeLinePathType.changeTo"),options:V,value:Ce,disabledOptions:["any","simple",xe],onChange:e=>Ee(e)}]},{id:"changeColor",title:q("header.settings.procedures.changeColor.title"),onClose:()=>Oe(!ve),field:[{type:"custom",label:q("header.settings.procedures.changeColor.changeFrom"),component:s.jsx(z,{data:ke,displayHandler:e=>s.jsx(W,{name:e.value,fg:e.theme[3],bg:e.theme[2],title:e.theme[1],sx:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis"}}),filter:(e,t)=>t.id.toLowerCase().includes(e.toLowerCase())||Object.values(t.id).some((t=>t.toLowerCase().includes(e.toLowerCase()))),value:Te.value,onChange:e=>Ne(e)})},{type:"custom",label:q("header.settings.procedures.changeColor.changeTo"),component:s.jsx(k,{theme:Le,onClick:()=>{We(!0),Q(I(G))}})}]}];return F.useEffect((()=>{t&&(ae(!1),oe(!1),pe(!1),je(!1),Oe(!1),ie(0),Ie([se,..._(U.current,Y?[...$].filter((e=>e.startsWith("stn")||e.startsWith("misc_node"))):U.current.nodes(),Y?[...$].filter((e=>e.startsWith("line"))):U.current.edges()).map((e=>({id:e.toString(),theme:e,value:"other"===e[1]?e[2]:e[1]})))]),Ne(se))}),[t]),s.jsxs(n,{isOpen:t,onClose:X,size:"md",scrollBehavior:"inside",children:[s.jsx(a,{}),s.jsxs(r,{children:[s.jsxs(i,{children:[s.jsx(l,{as:"b",fontSize:"xl",children:q(Y?"panel.details.multipleSelection.change":"header.settings.procedures.changeType.title")}),s.jsx(o,{})]}),s.jsx(c,{children:s.jsx(d,{allowMultiple:!0,children:Pe.map((e=>s.jsxs(u,{children:[s.jsxs(g,{onClick:e.onClose,children:[s.jsx(h,{as:"span",flex:"1",textAlign:"left",children:s.jsx(l,{as:"b",fontSize:"md",children:e.title})}),s.jsx(p,{})]}),s.jsx(y,{pb:4,children:s.jsx(P,{fields:e.field,minW:270})})]},e.id)))})}),s.jsxs(m,{children:[s.jsx(f,{colorScheme:"blue",variant:"outline",mr:"1",onClick:X,children:q("cancel")}),s.jsx(f,{colorScheme:"red",mr:"1",onClick:()=>{const e=null!=Z&&Z.includes("station")?[...$].filter((e=>e.startsWith("stn"))):Y?[]:U.current.filterNodes((e=>e.startsWith("stn"))),t=null!=Z&&Z.includes("misc-node")?[...$].filter((e=>e.startsWith("misc_node"))):Y?[]:U.current.filterNodes((e=>e.startsWith("misc_node"))),s=Y?[...$].filter((e=>e.startsWith("line"))):U.current.edges();Z&&!Z.includes("station")||!le||((e,t,s,n)=>{n.filter((s=>"any"===t||e.getNodeAttribute(s,"type")===t)).forEach((t=>{R(e,t,s)}))})(U.current,ce,ue,e),Z&&!Z.includes("line")||!he||((e,t,s,n,a)=>{a.filter((s=>"any"===t||e.getEdgeAttribute(s,"style")===t)).forEach((t=>{H(e,t,s,n)}))})(U.current,ye,fe,G,s),Z&&!Z.includes("line")||!Se||((e,t,s,n)=>{n.filter((s=>"any"===t||e.getEdgeAttribute(s,"type")===t)).forEach((t=>{D(e,t,s)}))})(U.current,xe,Ce,s),ve&&(Z&&!Z.includes("line")||((e,t,s,n)=>{n.filter((t=>x.includes(e.getEdgeAttribute(t,"style")))).forEach((n=>{const a=e.getEdgeAttributes(n),r=a[a.style].color;("any"===t||r[0]==t[0]&&r[1]==t[1]&&r[2]==t[2]&&r[3]==t[3])&&e.mergeEdgeAttributes(n,{[a.style]:{color:s}})}))})(U.current,"any"===Te.id?"any":Te.theme,Le,s),(!Z||Z.includes("misc-node")||Z.includes("station"))&&((e,t,s,n,a)=>{[...n,...a].forEach((n=>{const a=e.getNodeAttributes(n).type,r=e.getNodeAttribute(n,a);if(void 0!==r.color){const e=r.color;("any"===t||e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&e[3]==t[3])&&(r.color=s)}e.mergeNodeAttributes(n,{[a]:r})}))})(U.current,"any"===Te.id?"any":Te.theme,Le,e,t)),ne&&((e,t,s,n,a)=>{[...t,...s].forEach((t=>{e.setNodeAttribute(t,"zIndex",a)})),n.forEach((t=>{e.setEdgeAttribute(t,"zIndex",a)}))})(U.current,e,t,s,re),K(),X()},isDisabled:!(ne||le||he||Se||ve),children:q("apply")})]})]})]})}))}}}));
